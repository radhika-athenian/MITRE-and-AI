{
    "type": "bundle",
    "id": "bundle--6b87db84-138a-43a4-a192-ebd6eea6090c",
    "spec_version": "2.0",
    "objects": [
        {
            "type": "relationship",
            "id": "relationship--577e10be-95b2-448c-bd12-1ee31f9514b6",
            "created": "2022-03-30T14:26:51.848Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "revoked": false,
            "external_references": [
                {
                    "source_name": "Now You Serial",
                    "description": "Rahman, Alyssa. (2021, December 13). Now You Serial, Now You Don\u2019t \u2014 Systematically Hunting for Deserialization Exploits. Retrieved November 28, 2023.",
                    "url": "https://www.mandiant.com/resources/blog/hunting-deserialization-exploits"
                }
            ],
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "modified": "2025-04-16T22:16:28.943Z",
            "description": "Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection strings or known payloads. For example, monitor for successively chained functions that adversaries commonly abuse (i.e. gadget chaining) through unsafe deserialization to exploit publicly facing applications for initial access.(Citation: Now You Serial) In AWS environments, monitor VPC flow logs and/or Elastic Load Balancer (ELB) logs going to and from instances hosting externally accessible applications.\n\n<code> (source=\"/var/log/zeek/http.log\" OR source=\"C:\\\\Windows\\\\System32\\\\LogFiles\\\\Firewall\")\n| regex http_request=\"(?i)select.*from|union.*select|cmd=.*|exec=.*\"\n| stats count by src_ip, dest_ip, http_method, uri_path\n| where count > 10\n| table _time, src_ip, dest_ip, http_method, uri_path, count</code>",
            "relationship_type": "detects",
            "source_ref": "x-mitre-data-component--3772e279-27d6-477a-9fe3-c6beb363594c",
            "target_ref": "attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c",
            "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_deprecated": false,
            "x_mitre_attack_spec_version": "3.2.0"
        }
    ]
}